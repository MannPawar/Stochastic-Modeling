sd_value = sd(value),
count = n())
a.noshow <- 20
sd.noshow <- 5
c.unused <- 300
c.voucher <- 600
#Decision Variable
overbook <- seq(15)
nsim <- 2
tibble(simulation=rep(1:length(overbook)))
tibble(simulation=rep(1:length(overbook),each=nsim))
source("~/Stochastic Modelling/MonteCarloSim.R", echo = TRUE)
tibble(simulation=rep(1:length(overbook),each=nsim),
overbook=rep(overbook,each=nsim))
library(tidyverse)
library(ggthemes)
a.noshow <- 20
sd.noshow <- 5
c.unused <- 300
c.voucher <- 600
#Decision Variable
overbook <- seq(15,16)
nsim <- 2
tibble(simulation=rep(1:length(overbook),each=nsim),
overbook=rep(overbook,each=nsim))
a.noshow <- 20
sd.noshow <- 5
c.unused <- 300
c.voucher <- 600
#Decision Variable
overbook <- seq(15,16)
nsim <- 2
tibble(simulation=rep(1:length(overbook),each=nsim),
overbook=rep(overbook,each=nsim),
noshows=rnorm(nsim*length(overbook), a.noshow,sd.noshow))
source("~/.active-rstudio-document", echo = TRUE)
source("~/.active-rstudio-document", echo = TRUE)
set.seed(10)
tibble(simulation=rep(1:length(Overbook),each=nsim),
overbook=rep(overbook,each=nsim),
noshows=round(rnorm(nsim*length(Overbook), a.noshow,sd.noshow)),
cost=case_when(noshows>overbook~300*(noshows-overbook),
TRUE~600(overbook-noshows)))
tibble(simulation=rep(1:length(Overbook),each=nsim),
overbook=rep(overbook,each=nsim),
noshows=round(rnorm(nsim*length(Overbook), a.noshow,sd.noshow)),
cost=case_when(noshows>overbook~300*(noshows-overbook),
TRUE~600*(overbook-noshows)))
source("~/.active-rstudio-document", echo = TRUE)
source("~/.active-rstudio-document", echo = TRUE)
source("~/.active-rstudio-document", echo = TRUE)
source("~/.active-rstudio-document", echo = TRUE)
source("~/.active-rstudio-document", echo = TRUE)
source("~/.active-rstudio-document", echo = TRUE)
sim %>% group_by(simulation) %>%
summarise(Overbook = mean(overbook),
A.Cost=mean(cost))
source("~/.active-rstudio-document", echo = TRUE)
source("~/.active-rstudio-document", echo = TRUE)
source("~/.active-rstudio-document", echo = TRUE)
sim %>% group_by(simulation) %>%
summarise(Overbook = mean(overbook),
A.Cost=mean(cost)) %>%
ggplot() + geom_line(aes(x=simulation, y=A.Cost))
initial <- 1000
initial <- 1000
time_period <- seq(20)
initial <- 1000
yi<-6000
a.return <- 0.1
sd.return <- 0.18
years <- 20
#Simulation
nsim <- 2
tibble(simulation=rep(1:nsim,each=years),
period<-rep(1:years,nsim),
returns=rnorm(years*nsim,a.return,sd.return))
set.seed(10)
tibble(simulation=rep(1:nsim,each=years),
period<-rep(1:years,nsim),
returns=rnorm(years*nsim,a.return,sd.return))
#Simulation
nsim <- 2
set.seed(10)
tibble(simulation=rep(1:nsim,each=years),
period<-rep(1:years,nsim),
returns=rnorm(years*nsim,a.return,sd.return) %>%
group_by(simulation) %>%
mutate(Value = accumulate(returns[-1], ~ .x(1+.y)+yi,
.init = initial * (1+returns[1]) + yi))
)
initial <- 1000
yi <- 6000
a.return <- 0.1
sd.return <- 0.18
years <- 20
#Simulation
nsim <- 2
set.seed(10)
tibble(simulation=rep(1:nsim,each=years),
period<-rep(1:years,nsim),
returns=rnorm(years*nsim,a.return,sd.return) %>%
group_by(simulation) %>%
mutate(Value = accumulate(returns[-1], ~ .x(1+.y)+yi,
.init = initial * (1+returns[1]) + yi))
)
#Simulation
nsim <- 2
set.seed(10)
tibble(simulation=rep(1:nsim,each=years),
period<-rep(1:years,nsim),
returns=rnorm(years*nsim,a.return,sd.return) %>%
group_by(simulation) %>%
mutate(Value = accumulate(returns[-1], ~ .x*(1+.y)+yi,
.init = initial * (1+returns[1]) + yi))
)
initial <- 1000
yi <- 6000
a.return <- 0.1
sd.return <- 0.18
years <- 20
#Simulation
nsim <- 2
set.seed(10)
tibble(simulation=rep(1:nsim,each=years),
period<-rep(1:years,nsim),
returns=rnorm(years*nsim,a.return,sd.return) %>%
group_by(simulation) %>%
mutate(Value = accumulate(returns[-1], ~ .x*(1+.y)+yi,
.init = initial * (1+returns[1]) + yi)))
tibble(simulation=rep(1:nsim,each=years),
period<-rep(1:years,nsim),
returns=rnorm(years*nsim,a.return,sd.return) %>%
group_by(simulation) %>%
mutate(Value = accumulate(returns[-1], ~ .x*(1+.y)+yi,
.init = initial * (1+returns[1]) + yi)))
initial <- 1000
yi <- 6000
a.return <- 0.1
sd.return <- 0.18
years <- 20
#Simulation
nsim <- 2
set.seed(10)
tibble(simulation=rep(1:nsim,each=years),
period<-rep(1:years,nsim),
returns=rnorm(years*nsim,a.return,sd.return) %>%
group_by(simulation) %>%
mutate(Value = accumulate(returns[-1], ~ .x*(1+.y)+yi,
.init = initial * (1+returns[1]) + yi)))
sim <- (tibble(simulation=rep(1:nsim,each=years),
period<-rep(1:years,nsim),
returns=rnorm(years*nsim,a.return,sd.return) %>%
group_by(simulation) %>%
mutate(Value = accumulate(returns[-1], ~ .x*(1+.y)+yi,
.init = initial * (1+returns[1]) + yi))))
#Simulation
nsim <- 2
set.seed(10)
sim <-(tibble(simulation=rep(1:nsim,each=years),
period<-rep(1:years,nsim),
returns=rnorm(years*nsim,a.return,sd.return) %>%
group_by(simulation) %>%
mutate(Value = accumulate(returns[-1], ~ .x*(1+.y)+yi,
.init = initial * (1+returns[1]) + yi))))
# --- 0. Clear Environment and Load All Libraries ---
rm(list=ls())
library(quantmod)
library(tidyverse)
library(fpp3)
library(ggthemes)
# --- 1. Load Stock Data (quantmod) ---
# This creates 'azo_data'
getSymbols("AZO", from = "2020-01-01", to = Sys.Date(), src = "yahoo")
azo_data <- data.frame(
date = index(AZO),
Open = as.numeric(AZO$AZO.Open),
High = as.numeric(AZO$AZO.High),
Low = as.numeric(AZO$AZO.Low),
Close = as.numeric(AZO$AZO.Close),
Volume = as.numeric(AZO$AZO.Volume),
Adjusted = as.numeric(AZO$AZO.Adjusted)
)
View(AZO)
# --- 1. Create the data.frame ---
# This converts the 'AZO' (xts) object into a standard 'data.frame'
azo_data <- data.frame(
date = index(AZO),
Open = as.numeric(AZO$AZO.Open),
High = as.numeric(AZO$AZO.High),
Low = as.numeric(AZO$AZO.Low),
Close = as.numeric(AZO$AZO.Close),
Volume = as.numeric(AZO$AZO.Volume),
Adjusted = as.numeric(AZO$AZO.Adjusted)
)
# --- 2. Create the tsibble ---
# This converts the 'azo_data' (data.frame) into the 'tsibble'
azo_tsbl_daily <- azo_data %>%
mutate(date = as_date(date)) %>%
as_tsibble(index = date) %>%
fill_gaps()
head(AZO)
str(AZO)
# --- 1. Create the data.frame ---
# This converts the 'AZO' (xts) object into a standard 'data.frame'
azo_data <- data.frame(
date = xts::index(AZO),
Open = as.numeric(AZO$AZO.Open),
High = as.numeric(AZO$AZO.High),
Low = as.numeric(AZO$AZO.Low),
Close = as.numeric(AZO$AZO.Close),
Volume = as.numeric(AZO$AZO.Volume),
Adjusted = as.numeric(AZO$AZO.Adjusted)
)
# --- 0. Clear Environment and Load All Libraries ---
rm(list=ls())
library(quantmod)
library(tidyverse)
library(ggthemes)
# --- 0. Clear Environment and Load All Libraries ---
rm(list=ls())
library(quantmod)
library(tidyverse)
library(ggthemes)
# --- 1. Load Stock Data (quantmod) ---
# This creates 'azo_data'
getSymbols("AZO", from = "2020-01-01", to = Sys.Date(), src = "yahoo")
head(AZO)
str(AZO)
# --- 1. Create the data.frame ---
# This converts the 'AZO' (xts) object into a standard 'data.frame'
azo_data <- data.frame(
date = xts::index(AZO),
Open = as.numeric(AZO$AZO.Open),
High = as.numeric(AZO$AZO.High),
Low = as.numeric(AZO$AZO.Low),
Close = as.numeric(AZO$AZO.Close),
Volume = as.numeric(AZO$AZO.Volume),
Adjusted = as.numeric(AZO$AZO.Adjusted)
)
# --- 1. Create the data.frame ---
# This converts the 'AZO' (xts) object into a standard 'data.frame'
azo_data <- data.frame(
date = index(AZO),
Open = as.numeric(AZO$AZO.Open),
High = as.numeric(AZO$AZO.High),
Low = as.numeric(AZO$AZO.Low),
Close = as.numeric(AZO$AZO.Close),
Volume = as.numeric(AZO$AZO.Volume),
Adjusted = as.numeric(AZO$AZO.Adjusted)
)
library(fpp3)
# --- 2. Create the tsibble ---
# This converts the 'azo_data' (data.frame) into the 'tsibble'
azo_tsbl_daily <- azo_data %>%
mutate(date = as_date(date)) %>%
as_tsibble(index = date) %>%
fill_gaps()
# --- 3. Check the result ---
# If this command works and prints the data, you are ready to forecast
head(azo_tsbl_daily)
azo_data <- data.frame(
date = index(AZO),
Open = as.numeric(AZO$AZO.Open),
High = as.numeric(AZO$AZO.High),
Low = as.numeric(AZO$AZO.Low),
Close = as.numeric(AZO$AZO.Close),
Volume = as.numeric(AZO$AZO.Volume),
Adjusted = as.numeric(AZO$AZO.Adjusted)
)
# --- 3. Create Revenue Data ---
# This creates 'revenue_long'
fiscal_year <- c(2025, 2025, 2025, 2025,
2024, 2024, 2024, 2024,
2023, 2023, 2023, 2023,
2022, 2022, 2022, 2022,
2021, 2021, 2021, 2021)
quarter <- rep(c("Q1", "Q2", "Q3", "Q4"), times = 5)
revenue <- c(
3.95, 4.46, 4.50, 6.24,
3.70, 3.95, 4.09, 5.69,
3.70, 3.69, 4.09, 5.69,
3.59, 3.69, 3.99, 5.39,
3.39, 3.49, 3.79, 5.19
)
revenue_long <- data.frame(
Fiscal_Year = fiscal_year,
Quarter = quarter,
Revenue = revenue
)
# Prepare the revenue tsibble
revenue_long %>%
mutate(Quarter_Date = yearquarter(paste(Fiscal_Year, Quarter))) %>%
arrange(Quarter_Date) %>%
as_tsibble(index = Quarter_Date) -> revenue_ts
# Fit the automated ETS model
revenue_ts %>%
model(ETS_Model = ETS(Revenue)) -> final_revenue_fit
# Report and Glance
report(final_revenue_fit)
glance(final_revenue_fit)
# Generate the final forecast (8 quarters)
final_revenue_fit %>%
forecast(h = 8) %>%
hilo(level = 90) -> final_revenue_fc
# Print the final forecast table
print(final_revenue_fc)
# --- 5. Revenue Forecast Plot (autoplot) ---
# This will now work because PerformanceAnalytics is not loaded
final_revenue_fc %>%
autoplot(revenue_ts) +
labs(title = "AutoZone Revenue Forecast (ETS Model)",
y = "Revenue (Billion USD)") +
theme_classic()
# --- 0. Clear Environment and Load All Libraries ---
rm(list=ls())
library(quantmod)
library(tidyverse)
library(fpp3)
library(ggthemes)
# --- 1. Load Stock Data (quantmod) ---
# This creates the 'AZO' (xts) object
getSymbols("AZO", from = "2020-01-01", to = Sys.Date(), src = "yahoo")
# --- 2. Create the 'azo_data' (data.frame) object ---
# ***** THIS IS THE FIX *****
# The 'index' function comes from the 'zoo' package, not 'xts'
azo_data <- data.frame(
date = zoo::index(AZO),
Open = as.numeric(AZO$AZO.Open),
High = as.numeric(AZO$AZO.High),
Low = as.numeric(AZO$AZO.Low),
Close = as.numeric(AZO$AZO.Close),
Volume = as.numeric(AZO$AZO.Volume),
Adjusted = as.numeric(AZO$AZO.Adjusted)
)
# --- 3. Create Revenue Data ---
# This creates 'revenue_long'
fiscal_year <- c(2025, 2025, 2025, 2025,
2024, 2024, 2024, 2024,
2023, 2023, 2023, 2023,
2022, 2022, 2022, 2022,
2021, 2021, 2021, 2021)
quarter <- rep(c("Q1", "Q2", "Q3", "Q4"), times = 5)
revenue <- c(
3.95, 4.46, 4.50, 6.24,
3.70, 3.95, 4.09, 5.69,
3.70, 3.69, 4.09, 5.69,
3.59, 3.69, 3.99, 5.39,
3.39, 3.49, 3.79, 5.19
)
revenue_long <- data.frame(
Fiscal_Year = fiscal_year,
Quarter = quarter,
Revenue = revenue
)
# Prepare the revenue tsibble
revenue_long %>%
mutate(Quarter_Date = yearquarter(paste(Fiscal_Year, Quarter))) %>%
arrange(Quarter_Date) %>%
as_tsibble(index = Quarter_Date) -> revenue_ts
# Fit the automated ETS model
revenue_ts %>%
model(ETS_Model = ETS(Revenue)) -> final_revenue_fit
# Report and Glance
report(final_revenue_fit)
glance(final_revenue_fit)
# Generate the final forecast (8 quarters)
final_revenue_fit %>%
forecast(h = 8) %>%
hilo(level = 90) -> final_revenue_fc
# Print the final forecast table
print(final_revenue_fc)
# --- 5. Revenue Forecast Plot (autoplot) ---
# This will work because we're not loading PerformanceAnalytics
final_revenue_fc %>%
autoplot(revenue_ts) +
labs(title = "AutoZone Revenue Forecast (ETS Model)",
y = "Revenue (Billion USD)") +
theme_classic()
# Prepare the daily stock price tsibble (must fill gaps)
azo_data %>%
mutate(date = as_date(date)) %>%
as_tsibble(index = date) %>%
fill_gaps() -> azo_tsbl_daily
# Fit the Naive_Drift model
azo_tsbl_daily %>%
model(Naive_Drift = NAIVE(Adjusted ~ drift())) -> final_stock_fit
# Report and Glance
report(final_stock_fit)
glance(final_stock_fit)
# Generate the final forecast (e.g., "3 months")
final_stock_fit %>%
forecast(h = "3 months") %>%
hilo(level = 90) -> final_stock_fc
# Print the final forecast table
print(final_stock_fc)
# Filter for a cleaner plot
azo_tsbl_daily %>%
filter(year(date) >= 2024) -> azo_recent
# --- 7. Stock Price Plot (autoplot) ---
# This will also work
final_stock_fc %>%
autoplot(azo_recent) +
labs(title = "AutoZone Stock Price Forecast (Naive with Drift)",
y = "Price (USD)") +
theme_classic()
# --- 0. Clear Environment and Load All Libraries ---
rm(list=ls())
library(quantmod)
library(tidyverse)
library(fpp3)
library(ggthemes)
# --- 1. Load Stock Data (quantmod) ---
# This creates the 'AZO' (xts) object
getSymbols("AZO", from = "2020-01-01", to = Sys.Date(), src = "yahoo")
# --- 2. Create the 'azo_data' (data.frame) object ---
# We use zoo::index() to prevent package conflicts
azo_data <- data.frame(
date = zoo::index(AZO),
Open = as.numeric(AZO$AZO.Open),
High = as.numeric(AZO$AZO.High),
Low = as.numeric(AZO$AZO.Low),
Close = as.numeric(AZO$AZO.Close),
Volume = as.numeric(AZO$AZO.Volume),
Adjusted = as.numeric(AZO$AZO.Adjusted)
)
# --- 3. Create Revenue Data ---
# This creates 'revenue_long'
fiscal_year <- c(2025, 2025, 2025, 2025,
2024, 2024, 2024, 2024,
2023, 2023, 2023, 2023,
2022, 2022, 2022, 2022,
2021, 2021, 2021, 2021)
quarter <- rep(c("Q1", "Q2", "Q3", "Q4"), times = 5)
revenue <- c(
3.95, 4.46, 4.50, 6.24,
3.70, 3.95, 4.09, 5.69,
3.70, 3.69, 4.09, 5.69,
3.59, 3.69, 3.99, 5.39,
3.39, 3.49, 3.79, 5.19
)
revenue_long <- data.frame(
Fiscal_Year = fiscal_year,
Quarter = quarter,
Revenue = revenue
)
# Prepare the revenue tsibble
revenue_long %>%
mutate(Quarter_Date = yearquarter(paste(Fiscal_Year, Quarter))) %>%
arrange(Quarter_Date) %>%
as_tsibble(index = Quarter_Date) -> revenue_ts
# Fit the automated ETS model
revenue_ts %>%
model(ETS_Model = ETS(Revenue)) -> final_revenue_fit
# Report and Glance
report(final_revenue_fit)
glance(final_revenue_fit)
# Generate the final forecast (8 quarters)
final_revenue_fit %>%
forecast(h = 8) %>%
hilo(level = 90) -> final_revenue_fc
# Print the final forecast table
print(final_revenue_fc)
# Extract the forecast into a simple data frame
revenue_fc_data <- as_tibble(final_revenue_fc)
# Manually split the '90%' hilo column
revenue_fc_data <- revenue_fc_data %>%
unpack_hilo('90%')
# Manually build the plot
ggplot(revenue_ts, aes(x = Quarter_Date)) +
geom_line(aes(y = Revenue), color = "black") + # Original data
geom_line(data = revenue_fc_data, aes(y = .mean), color = "blue", linetype = "dashed") + # Forecast mean
geom_ribbon(data = revenue_fc_data, aes(ymin = `90%_lower`, ymax = `90%_upper`),
fill = "blue", alpha = 0.2) + # Confidence interval
labs(title = "AutoZone Revenue Forecast (ETS Model)",
y = "Revenue (Billion USD)", x = "Quarter") +
theme_classic()
# Prepare the daily stock price tsibble (must fill gaps)
azo_data %>%
mutate(date = as_date(date)) %>%
as_tsibble(index = date) %>%
fill_gaps() -> azo_tsbl_daily
# Fit the Naive_Drift model
azo_tsbl_daily %>%
model(Naive_Drift = NAIVE(Adjusted ~ drift())) -> final_stock_fit
# Report and Glance
report(final_stock_fit)
glance(final_stock_fit)
# Generate the final forecast (e.g., "3 months")
final_stock_fit %>%
forecast(h = "3 months") %>%
hilo(level = 90) -> final_stock_fc
# Print the final forecast table
print(final_stock_fc)
# Filter for a cleaner plot
azo_tsbl_daily %>%
filter(year(date) >= 2024) -> azo_recent
# Extract the forecast into a simple data frame
stock_fc_data <- as_tibble(final_stock_fc)
# Manually split the '90%' hilo column
stock_fc_data <- stock_fc_data %>%
unpack_hilo('90%')
# Manually build the plot
ggplot(azo_recent, aes(x = date)) +
geom_line(aes(y = Adjusted), color = "black") + # Original data
geom_line(data = stock_fc_data, aes(y = .mean), color = "blue", linetype = "dashed") + # Forecast mean
geom_ribbon(data = stock_fc_data, aes(ymin = `90%_lower`, ymax = `90%_upper`),
fill = "blue", alpha = 0.2) + # Confidence interval
labs(title = "AutoZone Stock Price Forecast (Naive with Drift)",
y = "Price (USD)", x = "Date") +
theme_classic()
source("~/Stochastic Modelling/LastPresentation.R", echo = TRUE)
